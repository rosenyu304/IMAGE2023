---
title: "Generative Seismic Kriging with Normalizing Flows"
author:
  - name: Rafael Orozco
    affiliations:
      name: Georgia Institute of Technology
  - name: Mathias Louboutin
    affiliations:
      name: Georgia Institute of Technology
  - name: Felix J. Herrmann
    affiliations:
      name: Georgia Institute of Technology
description: | 
  empty
bibliography: abstract.bib
abstract: |
  empty
---

::: {.hidden}
$$
    \newcommand{\pluseq}{\mathrel{+}=}
$$
:::

# Image 2023 abstract


## OBJECTIVES AND SCOPE (581/600 characters)

The objective is to demonstrate the applicability of Normalizing Flows (NFs) to subsurface kriging from wells. We will show that after supervised training, we can generate multiple realistic samples of plausible earth models that match the observed wells. We observe that these samples produce uncertainty statistics that are correlated with the complex parts of the model. The applicability of this method is for areas nearby the original survey used for training. Finally, we compare the speed and quality of our solutions with those obtained using a traditional variogram approach.

## METHODS, PROCEDURES, PROCESS (1406/1500 characters)

Kriging is highly ill-posed (there is no unique solution), therefore, ideal methods should be able to produce many models that match the observed well log data. Generative deep learning can be used to sample models that are conditioned on observations. A particular class of generative deep learning are normalizing flows. These are particularly attractive because they are fast to sample from and have low training memory requirements from their invertibility. We implemented our architecture in Julia with InvertibleNetworks.jl.

Our method is supervised and needs training examples of observed wells "y" with its corresponding full earth models "x". We use the 3D compass model with a 90%/5%/5% training/validation/test split of its 2D slices. For each training slice (nz=256, nx=512, d=10m) of the compass volume, we randomly generate well observations by selecting 5 horizontal locations at least 200 meters from each other. This process creates the training pairs (x_i,y_i) used to train the conditional normalizing flow.  (How many total?)

After training, we input an unseen well log y distribution (5 wells) and produce posterior samples p(x|y) (earth models). To create a single point estimate, we average all posterior samples to get the posterior mean.

For the variogram, we use exponential ordinary variogram from the package PyKrige. The variogram parameters are automatically selected by the well log data. We manually set the anisotropy angle to 0 to match the overall horizontally layered structure Compass model.

## RESULTS, OBSERVATIONS, CONCLUSIONS (1665/1500 characters)

In Figure 2, we show posterior samples generated with our method where each sample takes 10ms to compute on a single GPU. To validate the quality of the earth models produced, we compare the posterior mean with the known ground truth from a leave-out test set. We compare various metrics (SSIM, PSNR, RSME and time-to-compute) and verify that our method produces better reconstructions while being faster than a variogram approach. 

We study the uncertainty of our approach by considering the variance between the different posterior samples compared with the calculated standard variation of the variogram. We see in Figure 2 that our method produces uncertainty results that are more interpretable and correlate with specific structures in the subsurface.

The table in Figure 2 shows the quantitative performance of our method. Our method produces a high quality point estimates with an average RMSE of 0.038 compared to the variogram with an average RMSE of 0.043. The posterior mean gives a smooth model with less error on average. Therefore we recommend practitioners use posterior samples as they maintain realistic earth characteristics. 

This method has learned long range structures in the training survey area and can extrapolate them further. Generalization to other survey areas is out of the scope of this project but future work will explore it. We conclude that our method is a promising option for creating realistic earth models that match observed data wells and that it offers quantitative advantages over traditional approaches.

## SIGNIFICANCE/NOVELTY  (663/600 characters)

We introduce the first use of conditional normalizing flows for kriging. While previous implementations of conditional normalizing flows have struggled on high dimensional images, we demonstrated our software implementation allows for learning distributions over large realistic models. This method is set to scale to 3D models in future work which will further enable the application of these methods to real-world seismic problems. In contrast with traditional variogram methods, our framework produces realistic samples, that is particularly important for downstream tasks in reservoir engineering and other applications where multiple plausible models are needed.

::: {#fig-1 layout-ncol=1}

![fig1](figures/full_schematic.png){width=100%}

Schematic of full training process and test time evaluation of our method. 

:::

::: {#fig-2 layout-ncol=1}

![fig2](figures/results.png){width=100%}

Results from our method compared with exponential variogram. Our method produces realistic samples of earth models that when averaged produce high quality point estimates. 

:::